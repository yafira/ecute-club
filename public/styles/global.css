/* ------------------------------------------------------------
   ecute.club â€” global.css (updated)
   - IBM Plex Mono everywhere
   - Card icons turn black in dark mode
   - Strong diagram text readability halo (light + dark)
------------------------------------------------------------- */

/* load font */
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap');

/* ---------- design tokens ---------- */
:root {
	/* colors */
	--bg: #fffdf9;
	--ink: #1e1b19;
	--muted: #67615b;
	--card: #ffffff;
	--line: color-mix(in oklab, var(--ink) 12%, transparent);

	/* pastels */
	--p1: #ffdfe7; /* pink */
	--p2: #fff3c9; /* butter */
	--p3: #daf6e5; /* mint */
	--p4: #e7e7ff; /* lavender */
	--p5: #f4efe6; /* oat */

	/* icon ink (overridable in dark) */
	--icon-ink: var(--ink);

	/* shape + motion */
	--r-lg: 18px;
	--r-sm: 12px;
	--elev-1: 0 6px 20px rgba(0, 0, 0, 0.06), inset 0 0 0 1px var(--line);
	--elev-2: 0 12px 28px rgba(0, 0, 0, 0.1), inset 0 0 0 1px var(--line);
	--speed: 160ms;

	/* layout */
	--container: min(1100px, 92vw);
	--grid-min: 300px;

	/* typography scale */
	--fs-0: 14px;
	--fs-1: clamp(15.5px, 1.4vw, 17px);
	--fs-2: clamp(18px, 2.1vw, 20px);
	--fs-3: clamp(22px, 2.8vw, 26px);
	--fs-4: clamp(28px, 3.8vw, 34px);
	--lh: 1.55;

	/* bg controls */
	--bg-grid: color-mix(in oklab, var(--ink) 12%, transparent);
	--bg-grid-size: 22px;
	--bg-dot: 1.1px; /* not used now, fine to keep */
}

:root.dark {
	--bg: #121112;
	--ink: #f6f3ee;
	--muted: #b9b2aa;
	--card: #1b191b;
	--line: color-mix(in oklab, var(--ink) 14%, transparent);
	--elev-1: 0 6px 20px rgba(0, 0, 0, 0.4), inset 0 0 0 1px var(--line);
	--elev-2: 0 14px 30px rgba(0, 0, 0, 0.5), inset 0 0 0 1px var(--line);

	/* icons go black on dark */
	--icon-ink: #000;

	--bg-grid: color-mix(in oklab, var(--ink) 20%, transparent);
}

/* Improve callout readability in dark mode */
:root.dark .callout,
:root.dark .callout.ok,
:root.dark .callout.info,
:root.dark .callout.warn {
	color: #111; /* near-black ink over pastels */
}

:root.dark .callout a {
	color: #111;
	text-decoration-color: #111; /* keep underline visible */
}

/* optional: slightly stronger pastel in dark so text pops more */
:root.dark .callout {
	background: color-mix(in oklab, var(--p2) 88%, #fff 12%);
}
:root.dark .callout.ok {
	background: color-mix(in oklab, var(--p3) 88%, #fff 12%);
}
:root.dark .callout.info {
	background: color-mix(in oklab, var(--p4) 88%, #fff 12%);
}
:root.dark .callout.warn {
	background: color-mix(in oklab, var(--p1) 88%, #fff 12%);
}

/* ---------- base ---------- */
* {
	box-sizing: border-box;
}
html,
body {
	height: 100%;
}

body {
	margin: 0;
	font-family: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Consolas,
		'Liberation Mono', monospace;

	/* dotted grid only (no blobs) */
	background: radial-gradient(
				var(--bg-grid) var(--bg-dot),
				transparent calc(var(--bg-dot) + 0.1px)
			)
			0 0 / var(--bg-grid-size) var(--bg-grid-size),
		radial-gradient(
				var(--bg-grid) var(--bg-dot),
				transparent calc(var(--bg-dot) + 0.1px)
			)
			calc(var(--bg-grid-size) / 2) calc(var(--bg-grid-size) / 2) /
			var(--bg-grid-size) var(--bg-grid-size),
		var(--bg);

	color: var(--ink);
	line-height: var(--lh);
	font-size: var(--fs-1);
	text-rendering: optimizeLegibility;
	-webkit-font-smoothing: antialiased;
}

/* homepage = crosshatched grid */
body.bg-grid {
	background: repeating-linear-gradient(
			to bottom,
			color-mix(in oklab, var(--ink) 8%, transparent) 0 1px,
			transparent 1px var(--bg-grid-size)
		),
		repeating-linear-gradient(
			to right,
			color-mix(in oklab, var(--ink) 8%, transparent) 0 1px,
			transparent 1px var(--bg-grid-size)
		),
		var(--bg) !important;
}

/* inner pages = notebook lines */
body.bg-lined {
	background: repeating-linear-gradient(
			to bottom,
			color-mix(in oklab, var(--ink) 10%, transparent) 0 1px,
			transparent 1px calc(var(--bg-grid-size) * 1.5)
		),
		var(--bg) !important;
}

.container {
	width: var(--container);
	margin: clamp(14px, 2vw, 24px) auto;
}

/* ---------- header / nav ---------- */
.site-header {
	position: sticky;
	top: 0;
	z-index: 10;
	backdrop-filter: saturate(1.1) blur(8px);
	background: color-mix(in oklab, var(--bg) 88%, transparent);
	border-bottom: 1px solid var(--line);
	padding: 10px clamp(8px, 2vw, 18px);
	display: grid;
	grid-template-columns: 1fr auto;
	align-items: center;
}
.brand {
	display: flex;
	align-items: center;
	gap: 10px;
	color: inherit;
	text-decoration: none;
	font-weight: 700;
	letter-spacing: 0.2px;
}
.brand-mark {
	width: 28px;
	height: 28px;
	filter: drop-shadow(0 1px 0 rgba(0, 0, 0, 0.04));
}

.site-nav a {
	color: var(--muted);
	text-decoration: none;
	padding: 8px 10px;
	border-radius: 12px;
	transition: background var(--speed), color var(--speed);
}
.site-nav a:hover {
	background: var(--p5);
	color: var(--ink);
}
:root.dark .site-nav a:hover {
	background: color-mix(in oklab, var(--card) 70%, transparent);
}

/* ---------- homepage grid cards ---------- */
.grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(var(--grid-min), 1fr));
	gap: 18px;
	margin: 20px 0 8px;
}
.card {
	background: linear-gradient(
		180deg,
		color-mix(in oklab, var(--card) 90%, var(--p5) 10%),
		var(--card)
	);
	border-radius: var(--r-lg);
	box-shadow: var(--elev-1);
	padding: 16px;
	text-decoration: none;
	color: inherit;
	display: grid;
	grid-template-columns: 64px 1fr;
	gap: 14px;
	align-items: center;
	transition: transform var(--speed), box-shadow var(--speed),
		background var(--speed);
	will-change: transform;
}
.card:hover {
	transform: translateY(-3px);
	box-shadow: var(--elev-2);
}

.card .icon {
	width: 64px;
	height: 64px;
	border-radius: 16px;
	display: grid;
	place-items: center;
	font-size: 28px;
	background: var(--p3);
	color: var(--icon-ink); /* icon glyph color follows variable */
}
.card[data-accent='p1'] .icon {
	background: var(--p1);
}
.card[data-accent='p2'] .icon {
	background: var(--p2);
}
.card[data-accent='p3'] .icon {
	background: var(--p3);
}
.card[data-accent='p4'] .icon {
	background: var(--p4);
}
.card[data-accent='p5'] .icon {
	background: var(--p5);
}
/* ensure FA glyph inherits the color */
.card .icon i {
	color: inherit;
}

.card h3 {
	margin: 0 0 4px;
	font-size: var(--fs-2);
}
.card p {
	margin: 0;
	color: var(--muted);
	font-size: var(--fs-1);
}

.section-head {
	display: flex;
	align-items: baseline;
	justify-content: space-between;
	gap: 12px;
	margin-top: 10px;
}
.section-head h2 {
	margin: 0;
	font-size: var(--fs-4);
	letter-spacing: 0.2px;
}
.section-head .hint {
	color: var(--muted);
	font-variant-numeric: tabular-nums;
}

/* ---------- article / prose ---------- */
article {
	width: var(--container);
	margin-inline: auto;
}
article h1 {
	font-size: var(--fs-4);
	margin: 18px 0 6px;
}
article h2 {
	font-size: var(--fs-3);
	margin: 22px 0 8px;
}
article h3 {
	font-size: var(--fs-2);
	margin: 16px 0 6px;
}
article p,
article li {
	max-width: 70ch;
}

article a {
	color: color-mix(in oklab, var(--ink) 80%, var(--p4) 20%);
	text-underline-offset: 2px;
}
article a:hover {
	text-decoration-thickness: 2px;
}

ul {
	padding-left: 1.25rem;
}
ul li {
	margin: 0.25rem 0;
}
ul li::marker {
	color: color-mix(in oklab, var(--ink) 60%, var(--p1) 40%);
}

/* code bits */
.mono,
code,
kbd {
	font-family: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Consolas,
		'Liberation Mono', monospace;
}
code {
	background: color-mix(in oklab, var(--card) 92%, var(--p5) 8%);
	padding: 0.15em 0.4em;
	border-radius: 8px;
	font-size: 0.95em;
}
kbd {
	background: color-mix(in oklab, var(--card) 90%, var(--p4) 10%);
	border: 1px solid var(--line);
	padding: 0.15em 0.45em;
	border-radius: 8px;
	box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.06);
}

/* callouts */
.callout {
	margin: 16px 0;
	padding: 14px 16px;
	border-radius: var(--r-lg);
	background: var(--p2);
	box-shadow: inset 0 0 0 1px var(--line);
}
.callout.info {
	background: var(--p4);
}
.callout.ok {
	background: var(--p3);
}
.callout.warn {
	background: color-mix(in oklab, var(--p1) 70%, white 30%);
}

/* tables */
table.cute {
	width: 100%;
	border-collapse: separate;
	border-spacing: 0;
	margin: 12px 0 18px;
	font-size: var(--fs-1);
}
table.cute thead th {
	text-align: left;
	color: var(--muted);
	font-weight: 700;
	padding: 10px 12px;
}
table.cute td {
	padding: 10px 12px;
	border-top: 1px solid var(--line);
}
table.cute tr:first-child td {
	border-top: none;
}
table.cute tr:nth-child(even) td {
	background: color-mix(in oklab, var(--card) 92%, var(--p5) 8%);
}
table.cute td strong {
	color: var(--ink);
}

/* diagrams */
.diagram {
	margin: 16px 0;
	padding: 12px;
	border-radius: var(--r-lg);
	background: var(--card);
	box-shadow: inset 0 0 0 1px var(--line);
}
/* default caption look */
.diagram .mono {
	font-size: 12px;
	fill: currentColor;
	opacity: 0.7;
}

/* --- SVG label readability: global, light & dark, Safari-friendly --- */
.diagram svg {
	color: var(--ink);
}

/* default labels with strong halo */
.diagram svg text {
	fill: currentColor;
	font-weight: 700;
	letter-spacing: 0.3px;
	paint-order: stroke fill;
	stroke: var(--card);
	stroke-width: 3.5px; /* thicker so it beats traces/pours */
	stroke-linejoin: round;
	text-rendering: geometricPrecision;
}
/* smaller captions */
.diagram svg text.mini {
	font-size: 12px;
	stroke-width: 2.5px;
	opacity: 0.95;
}
/* optional extra-strong halo */
.diagram.halo-strong svg text {
	stroke-width: 5px;
}
/* optional: disable halo for a specific diagram */
.diagram.no-halo svg text {
	stroke-width: 0;
	paint-order: normal;
}

/* Safari / older fallback */
@supports not (paint-order: stroke) {
	.diagram svg text {
		filter: drop-shadow(0 1px 0 var(--card)) drop-shadow(0 -1px 0 var(--card))
			drop-shadow(1px 0 0 var(--card)) drop-shadow(-1px 0 0 var(--card));
	}
}

/* footer */
.site-footer {
	border-top: 1px solid var(--line);
	padding: 28px 0;
	margin-top: 40px;
	text-align: center;
	color: var(--muted);
}
.site-footer a {
	color: inherit;
	text-decoration: none;
}

/* small screens - slightly tighter grid */
@media (max-width: 640px) {
	:root {
		--grid-min: 260px;
	}
	.card {
		grid-template-columns: 56px 1fr;
	}
	.card .icon {
		width: 56px;
		height: 56px;
		border-radius: 14px;
		font-size: 24px;
	}
}

/* print (for handouts) */
@media print {
	body {
		background: #fff;
		color: #000;
	}
	.site-header,
	.site-footer,
	.section-head .hint {
		display: none;
	}
	article a {
		color: #000;
		text-decoration: underline;
	}
}

/* ---------- resistor color bands ---------- */
.band {
	display: inline-block;
	padding: 4px 10px;
	border-radius: 6px;
	font-weight: 600;
	color: #fff;
	text-transform: lowercase;
	font-size: 0.9em;
}
.band.black {
	background: #000;
}
.band.brown {
	background: #6d3f00;
}
.band.red {
	background: #c00;
}
.band.orange {
	background: #ff7f00;
	color: #000;
}
.band.yellow {
	background: #ffcf00;
	color: #000;
}
.band.green {
	background: #008c00;
}
.band.blue {
	background: #004fc0;
}
.band.violet {
	background: #7a00aa;
}
.band.gray {
	background: #777;
}
.band.white {
	background: #eee;
	color: #000;
}
.band.gold {
	background: gold;
	color: #000;
}
.band.silver {
	background: silver;
	color: #000;
}
